<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="joyn">
<title>General use • joyn</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.0.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.0.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="General use">
<meta property="og:description" content="joyn">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">joyn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/general-use.html">General use</a>
    <a class="dropdown-item" href="../articles/advanced-use.html">Advanced use</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/randrescastaneda/joyn/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>General use</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/randrescastaneda/joyn/blob/HEAD/vignettes/general-use.Rmd" class="external-link"><code>vignettes/general-use.Rmd</code></a></small>
      <div class="d-none name"><code>general-use.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-basics">The basics<a class="anchor" aria-label="anchor" href="#the-basics"></a>
</h2>
<p>Notice too that <code><a href="../reference/merge.html">joyn::merge</a></code> masks <code><a href="https://rdrr.io/r/base/merge.html" class="external-link">base::merge</a></code>, which is ideal. Also, by loading <code>joyn</code> you have a few tables lazy-loaded in memory, x1, x2, x3, x4, y1, y2, y3, and y4.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/randrescastaneda/joyn" class="external-link">joyn</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'joyn'</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     merge</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span>
<span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span>, <span class="cn">NA_integer_</span><span class="op">)</span>,
                t  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="cn">NA_integer_</span><span class="op">)</span>,
                x  <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>

<span class="va">y1</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,
                y  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11L</span>, <span class="fl">15L</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span>


<span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span>,
                t  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="cn">NA_integer_</span><span class="op">)</span>,
                x  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">12</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>


<span class="va">y2</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span>,
                yd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span>,
                y  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11L</span>, <span class="fl">15L</span>, <span class="fl">20L</span>, <span class="fl">13L</span>, <span class="fl">10L</span><span class="op">)</span>,
                x  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>


<span class="va">y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span>,<span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"a"</span><span class="op">)</span>,
                 y  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11L</span>, <span class="fl">15L</span>, <span class="fl">18L</span>, <span class="fl">20L</span><span class="op">)</span><span class="op">)</span>

<span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span>,<span class="st">"b"</span>, <span class="st">"d"</span><span class="op">)</span>,
                 v<span class="op">=</span><span class="fl">8</span><span class="op">:</span><span class="fl">10</span>,
                 foo<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>

<span class="va">x4</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,
                id2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,
                t   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="cn">NA_integer_</span><span class="op">)</span>,
                x   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">12</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>


<span class="va">y4</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span>,
                id2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,
                y   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11L</span>, <span class="fl">15L</span>, <span class="fl">20L</span>, <span class="fl">13L</span>, <span class="fl">10L</span><span class="op">)</span>,
                x   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="summary-table">Summary table<a class="anchor" aria-label="anchor" href="#summary-table"></a>
</h3>
<p>You can see in the examples below that by default <code>joyn</code> displays a small summary table.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Natural join. i.e., using as key all the variables that appear in both tables.</span>
<span class="co"># without display the resulting table.</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span><span class="op">)</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`id`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:      x 2   33.3%</span>
<span class="co">#&gt; 2:  x &amp; y 3     50%</span>
<span class="co">#&gt; 3:      y 1   16.7%</span>
<span class="co">#&gt; 4:  total 6    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id  t  x  y report</span>
<span class="co">#&gt; 1:  1  1 11 11  x &amp; y</span>
<span class="co">#&gt; 2:  1  2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:  2  1 13 15  x &amp; y</span>
<span class="co">#&gt; 4:  3  2 14 NA      x</span>
<span class="co">#&gt; 5:  4 NA NA 16      y</span>
<span class="co">#&gt; 6: NA NA 15 NA      x</span></code></pre></div>
<p>You can use the reporting format of the <code>report</code> variables, by setting the argument <code>reporttype</code> to numeric, similar to Stata’s output.</p>
<table class="table">
<thead><tr class="header">
<th align="left">code</th>
<th align="center">report</th>
<th align="left">meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="center">x</td>
<td align="left">Only available in x table</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="center">y</td>
<td align="left">Only available in y table</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="center">x &amp; y</td>
<td align="left">Matching obs available in both tables</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="center">NA updated</td>
<td align="left">NAs in x updated with actual values in variables with same names in y</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="center">value updated</td>
<td align="left">Actual values and NAs in x updated with actual values in variables with same names in y</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="center">not updated</td>
<td align="left">Actual values and NAs in x are NOT updated with actual values in y</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="key-variables">Key variables<a class="anchor" aria-label="anchor" href="#key-variables"></a>
</h3>
<p>Since the object returned is a <code>data.table</code>, we display the results in the console by concatenating a pair of squared brackets at the end of the call. That is <code>merge(x1, y1)[]</code> instead of <code>merge(x1, y1)</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Natural join.  display the results.</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span><span class="op">)</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`id`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:      x 2   33.3%</span>
<span class="co">#&gt; 2:  x &amp; y 3     50%</span>
<span class="co">#&gt; 3:      y 1   16.7%</span>
<span class="co">#&gt; 4:  total 6    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id  t  x  y report</span>
<span class="co">#&gt; 1:  1  1 11 11  x &amp; y</span>
<span class="co">#&gt; 2:  1  2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:  2  1 13 15  x &amp; y</span>
<span class="co">#&gt; 4:  3  2 14 NA      x</span>
<span class="co">#&gt; 5:  4 NA NA 16      y</span>
<span class="co">#&gt; 6: NA NA 15 NA      x</span>

<span class="co"># Making explicit the key variables (strongly suggested)</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`id`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:      x 2   33.3%</span>
<span class="co">#&gt; 2:  x &amp; y 3     50%</span>
<span class="co">#&gt; 3:      y 1   16.7%</span>
<span class="co">#&gt; 4:  total 6    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id  t  x  y report</span>
<span class="co">#&gt; 1:  1  1 11 11  x &amp; y</span>
<span class="co">#&gt; 2:  1  2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:  2  1 13 15  x &amp; y</span>
<span class="co">#&gt; 4:  3  2 14 NA      x</span>
<span class="co">#&gt; 5:  4 NA NA 16      y</span>
<span class="co">#&gt; 6: NA NA 15 NA      x</span></code></pre></div>
<p>If the key variables have different names in both tables, you can create the equivalency as an element of <code>by</code> vector.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># joining by id1 in x and id in y</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x4</span>, <span class="va">y4</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id1 = id"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`keyby1`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">i</span> variables <span style="color: #262626; background-color: #DADADA;">`id2`</span> and <span style="color: #262626; background-color: #DADADA;">`x`</span> in table y are ignored because arguments `update_NAs`</span>
<span class="co">#&gt; </span>and `update_values` are FALSE.
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:  x &amp; y 5   71.4%</span>
<span class="co">#&gt; 2:      y 2   28.6%</span>
<span class="co">#&gt; 3:  total 7    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id1 id2  t  x  y report</span>
<span class="co">#&gt; 1:   1   1  1 16 11  x &amp; y</span>
<span class="co">#&gt; 2:   1   1  2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:   2   2  1 NA 15  x &amp; y</span>
<span class="co">#&gt; 4:   3   3  2 NA 10  x &amp; y</span>
<span class="co">#&gt; 5:   3   4 NA 15 10  x &amp; y</span>
<span class="co">#&gt; 6:   5  NA NA NA 20      y</span>
<span class="co">#&gt; 7:   6  NA NA NA 13      y</span>

<span class="co"># joining by id1 in x and id in y, and id2  in both</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x4</span>, <span class="va">y4</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id1 = id"</span>, <span class="st">"id2"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`keyby1`</span> and <span style="color: #262626; background-color: #DADADA;">`id2`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">i</span> variable <span style="color: #262626; background-color: #DADADA;">`x`</span> in table y is ignored because arguments `update_NAs` and</span>
<span class="co">#&gt; </span>`update_values` are FALSE.
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:      x 2     25%</span>
<span class="co">#&gt; 2:  x &amp; y 3   37.5%</span>
<span class="co">#&gt; 3:      y 3   37.5%</span>
<span class="co">#&gt; 4:  total 8    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id1 id2  t  x  y report</span>
<span class="co">#&gt; 1:   1   1  1 16 11  x &amp; y</span>
<span class="co">#&gt; 2:   1   1  2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:   2   2  1 NA NA      x</span>
<span class="co">#&gt; 4:   2   1 NA NA 15      y</span>
<span class="co">#&gt; 5:   3   3  2 NA NA      x</span>
<span class="co">#&gt; 6:   3   4 NA 15 10  x &amp; y</span>
<span class="co">#&gt; 7:   5   2 NA NA 20      y</span>
<span class="co">#&gt; 8:   6   3 NA NA 13      y</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="match-type">Match type<a class="anchor" aria-label="anchor" href="#match-type"></a>
</h2>
<p>Match type refers to the correspondence that exists between the observations of the joining tables. Following Stata’s convention, we could have four different match types, one-to-one (1:1) , one-to-many (1:m), many-to-one (m:1), and many-to-many (m:m) joins. The default is m:m, following general R’s practice, but its use is <strong>highly discouraged</strong>. We recommend you always specify the match type when joining tables to ensure the output is correct. Indeed, if you don’t care about match types or you don’t think it is necessary to use them for your particular needs, you might be fine without <code>joyn</code>.</p>
<p>Using the same wording of the <a href="https://www.stata.com/manuals/dmerge.pdf" class="external-link">Stata manual</a></p>
<ul>
<li><p><strong>1:1</strong>: specifies a one-to-one match merge. The variables specified in <code>by</code> <em>uniquely identify</em> single observations in both table.</p></li>
<li><p><strong>1:m and m:1</strong>: specify <em>one-to-many</em> and <em>many-to-one</em> match merges, respectively. This means that in of the tables the observations are uniquely identify by the variables in <code>by,</code> while in the other table many (two or more) of the observations are identify by the variables in <code>by</code>.</p></li>
<li><p><strong>m:m</strong> refers to <em>many-to-many joins</em>. variables in <code>by</code> does not uniquely identify the observations in either table. Matching is performed by combining observations with equal values in <code>by</code>; within matching values, the first observation in the master (i.e. left or x) table is matched with the first matching observation in the using (i.e. right or y) table; the second, with the second; and so on. If there is an unequal number of observations within a group, then the last observation of the shorter group is used repeatedly to match with subsequent observations of the longer group.</p></li>
</ul>
<p>Suppose you think your data is uniquely identified by variable <code>id</code>, it is not . If you used <code>match_type = "1:1"</code> you will get and error, letting you know that something is not right.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Merging correctly but getting error because something is not right in the data</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x3</span>, <span class="va">y3</span>, by <span class="op">=</span> <span class="st">"id"</span>, match_type <span class="op">=</span> <span class="st">"1:1"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #BB0000;">x</span> table <span style="color: #00BB00;">y</span> is not uniquely identified by <span style="color: #262626; background-color: #DADADA;">`id`</span></span>
<span class="co">#&gt; Error: match type inconsistency</span>
<span class="co">#&gt; <span style="color: #0000BB;">i</span> you could use `return_report = TRUE` in `joyn::is_id()`</span>
<span class="co">#&gt;     to see where the problem is</span>

<span class="co"># Merging wrongly but getting NO errors because  you did not use match_type</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x3</span>, <span class="va">y3</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`id`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:      x 1     20%</span>
<span class="co">#&gt; 2:  x &amp; y 3     60%</span>
<span class="co">#&gt; 3:      y 1     20%</span>
<span class="co">#&gt; 4:  total 5    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id  v foo  y report</span>
<span class="co">#&gt; 1:  a NA  NA 20      y</span>
<span class="co">#&gt; 2:  b  9   2 15  x &amp; y</span>
<span class="co">#&gt; 3:  c  8   4 11  x &amp; y</span>
<span class="co">#&gt; 4:  c  8   4 18  x &amp; y</span>
<span class="co">#&gt; 5:  d 10   7 NA      x</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="join-type">Join type<a class="anchor" aria-label="anchor" href="#join-type"></a>
</h2>
<p>Join type refers to observations that are kept after the join. To avoid confusion with argument <code>match_type</code>, I decided not to name this argument as <code>join_type</code> but as <code>keep</code>. At the end, you want to specify which observations you want to keep. This argument plays the role of mimicking the behavior of <code>dplyr</code>’s functions <code>left_join</code>, <code>right_join</code>, <code>inner_join</code>, and <code>full_join</code>, the default.</p>
<ul>
<li>
<p><code>keep = "full"</code>, the default, keeps all the observations in x and y, regardless of whether they match or not.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Full merge</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span><span class="op">)</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`id`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:      x 2   33.3%</span>
<span class="co">#&gt; 2:  x &amp; y 3     50%</span>
<span class="co">#&gt; 3:      y 1   16.7%</span>
<span class="co">#&gt; 4:  total 6    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id  t  x  y report</span>
<span class="co">#&gt; 1:  1  1 11 11  x &amp; y</span>
<span class="co">#&gt; 2:  1  2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:  2  1 13 15  x &amp; y</span>
<span class="co">#&gt; 4:  3  2 14 NA      x</span>
<span class="co">#&gt; 5:  4 NA NA 16      y</span>
<span class="co">#&gt; 6: NA NA 15 NA      x</span></code></pre></div>
</li>
<li>
<p><code>keep = "left"</code> or <code>keep = "master"</code> keeps all observations in x, regardless of whether they match or not with y.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># keep obs in x</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span>, keep <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`id`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:      x 2     40%</span>
<span class="co">#&gt; 2:  x &amp; y 3     60%</span>
<span class="co">#&gt; 3:  total 5    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id  t  x  y report</span>
<span class="co">#&gt; 1:  1  1 11 11  x &amp; y</span>
<span class="co">#&gt; 2:  1  2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:  2  1 13 15  x &amp; y</span>
<span class="co">#&gt; 4:  3  2 14 NA      x</span>
<span class="co">#&gt; 5: NA NA 15 NA      x</span></code></pre></div>
</li>
<li>
<p><code>keep = "right"</code> or <code>keep = "using"</code> keeps all observations in y, regardless of whether they match or not with x.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># keep obs in y</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span>, keep <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`id`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:  x &amp; y 3     75%</span>
<span class="co">#&gt; 2:      y 1     25%</span>
<span class="co">#&gt; 3:  total 4    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id  t  x  y report</span>
<span class="co">#&gt; 1:  1  1 11 11  x &amp; y</span>
<span class="co">#&gt; 2:  1  2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:  2  1 13 15  x &amp; y</span>
<span class="co">#&gt; 4:  4 NA NA 16      y</span></code></pre></div>
</li>
<li>
<p><code>keep = "inner"</code> keeps only the observations that match in both tables.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># keep matching obs in both tables</span>
<span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span>, keep <span class="op">=</span> <span class="st">"inner"</span><span class="op">)</span>
<span class="co">#&gt; &gt; removing key variables <span style="color: #262626; background-color: #DADADA;">`id`</span> from <span style="color: #00BB00;">yvars</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -- <span style="font-weight: bold;">JOYn Report</span> --</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    report n percent</span>
<span class="co">#&gt; 1:  x &amp; y 3    100%</span>
<span class="co">#&gt; 2:  total 3    100%</span>
<span class="co">#&gt; ---------------------------------------------------------- End of <span style="color: #00BB00;">JOYn</span> report --</span>
<span class="co">#&gt;    id t  x  y report</span>
<span class="co">#&gt; 1:  1 1 11 11  x &amp; y</span>
<span class="co">#&gt; 2:  1 2 12 11  x &amp; y</span>
<span class="co">#&gt; 3:  2 1 13 15  x &amp; y</span></code></pre></div>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://randrescastaneda.rbind.io/" class="external-link">R.Andres Castaneda</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
